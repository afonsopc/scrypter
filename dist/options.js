var o=Object.create;var{getPrototypeOf:d,defineProperty:I,getOwnPropertyNames:g}=Object;var m=Object.prototype.hasOwnProperty;var l=(c,n,B)=>{B=c!=null?o(d(c)):{};let H=n||!c||!c.__esModule?I(B,"default",{value:c,enumerable:!0}):B;for(let T of g(c))if(!m.call(H,T))I(H,T,{get:()=>c[T],enumerable:!0});return H};var s=(c,n)=>()=>(n||c((n={exports:{}}).exports,n),n.exports);var R=s((z,O)=>{(function(c,n){if(typeof define==="function"&&define.amd)define("webextension-polyfill",["module"],n);else if(typeof z!=="undefined")n(O);else{var B={exports:{}};n(B),c.browser=B.exports}})(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:z,function(c){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(!(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)){let B=(H)=>{let T={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(T).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class Q extends WeakMap{constructor(i,S=void 0){super(S);this.createItem=i}get(i){if(!this.has(i))this.set(i,this.createItem(i));return super.get(i)}}let P=(i)=>{return i&&typeof i==="object"&&typeof i.then==="function"},C=(i,S)=>{return(...E)=>{if(H.runtime.lastError)i.reject(new Error(H.runtime.lastError.message));else if(S.singleCallbackArg||E.length<=1&&S.singleCallbackArg!==!1)i.resolve(E[0]);else i.resolve(E)}},N=(i)=>i==1?"argument":"arguments",M=(i,S)=>{return function E(L,...h){if(h.length<S.minArgs)throw new Error(`Expected at least ${S.minArgs} ${N(S.minArgs)} for ${i}(), got ${h.length}`);if(h.length>S.maxArgs)throw new Error(`Expected at most ${S.maxArgs} ${N(S.maxArgs)} for ${i}(), got ${h.length}`);return new Promise((V,G)=>{if(S.fallbackToNoCallback)try{L[i](...h,C({resolve:V,reject:G},S))}catch(f){console.warn(`${i} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,f),L[i](...h),S.fallbackToNoCallback=!1,S.noCallback=!0,V()}else if(S.noCallback)L[i](...h),V();else L[i](...h,C({resolve:V,reject:G},S))})}},b=(i,S,E)=>{return new Proxy(S,{apply(L,h,V){return E.call(h,i,...V)}})},U=Function.call.bind(Object.prototype.hasOwnProperty),q=(i,S={},E={})=>{let L=Object.create(null),h={has(G,f){return f in i||f in L},get(G,f,J){if(f in L)return L[f];if(!(f in i))return;let $=i[f];if(typeof $==="function")if(typeof S[f]==="function")$=b(i,i[f],S[f]);else if(U(E,f)){let X=M(f,E[f]);$=b(i,i[f],X)}else $=$.bind(i);else if(typeof $==="object"&&$!==null&&(U(S,f)||U(E,f)))$=q($,S[f],E[f]);else if(U(E,"*"))$=q($,S[f],E["*"]);else return Object.defineProperty(L,f,{configurable:!0,enumerable:!0,get(){return i[f]},set(X){i[f]=X}}),$;return L[f]=$,$},set(G,f,J,$){if(f in L)L[f]=J;else i[f]=J;return!0},defineProperty(G,f,J){return Reflect.defineProperty(L,f,J)},deleteProperty(G,f){return Reflect.deleteProperty(L,f)}},V=Object.create(i);return new Proxy(V,h)},D=(i)=>({addListener(S,E,...L){S.addListener(i.get(E),...L)},hasListener(S,E){return S.hasListener(i.get(E))},removeListener(S,E){S.removeListener(i.get(E))}}),A=new Q((i)=>{if(typeof i!=="function")return i;return function S(E){let L=q(E,{},{getContent:{minArgs:0,maxArgs:0}});i(L)}}),x=new Q((i)=>{if(typeof i!=="function")return i;return function S(E,L,h){let V=!1,G,f=new Promise((Z)=>{G=function(K){V=!0,Z(K)}}),J;try{J=i(E,L,G)}catch(Z){J=Promise.reject(Z)}let $=J!==!0&&P(J);if(J!==!0&&!$&&!V)return!1;let X=(Z)=>{Z.then((K)=>{h(K)},(K)=>{let y;if(K&&(K instanceof Error||typeof K.message==="string"))y=K.message;else y="An unexpected error occurred";h({__mozWebExtensionPolyfillReject__:!0,message:y})}).catch((K)=>{console.error("Failed to send onMessage rejected reply",K)})};if($)X(J);else X(f);return!0}}),v=({reject:i,resolve:S},E)=>{if(H.runtime.lastError)if(H.runtime.lastError.message==="The message port closed before a response was received.")S();else i(new Error(H.runtime.lastError.message));else if(E&&E.__mozWebExtensionPolyfillReject__)i(new Error(E.message));else S(E)},W=(i,S,E,...L)=>{if(L.length<S.minArgs)throw new Error(`Expected at least ${S.minArgs} ${N(S.minArgs)} for ${i}(), got ${L.length}`);if(L.length>S.maxArgs)throw new Error(`Expected at most ${S.maxArgs} ${N(S.maxArgs)} for ${i}(), got ${L.length}`);return new Promise((h,V)=>{let G=v.bind(null,{resolve:h,reject:V});L.push(G),E.sendMessage(...L)})},u={devtools:{network:{onRequestFinished:D(A)}},runtime:{onMessage:D(x),onMessageExternal:D(x),sendMessage:W.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:W.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},F={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return T.privacy={network:{"*":F},services:{"*":F},websites:{"*":F}},q(H,u,T)};c.exports=B(chrome)}else c.exports=globalThis.browser})});var Y=l(R(),1),k=(c)=>{return typeof c.name==="string"&&typeof c.description==="string"&&typeof c.enabled==="boolean"&&Array.isArray(c.hostnames)&&c.hostnames.every((n)=>typeof n==="string")&&typeof c.code==="string"};class w{async getScripts(){let c=await Y.default.storage.local.get().then((n)=>n.scripts);if(!c||!Array.isArray(c))return await Y.default.storage.local.set({scripts:[]}),this.getScripts();return c.filter(k)}async addScript(c){if(!k(c))throw new Error("Invalid script format");let n=await this.getScripts();if(n.some((B)=>B.name===c.name))throw new Error("Script with this name already exists");n.push(c),await Y.default.storage.local.set({scripts:n})}async removeScript(c){let B=(await this.getScripts()).filter((H)=>H.name!==c);await Y.default.storage.local.set({scripts:B})}async updateScript(c,n){let B=await this.getScripts(),H=B.findIndex((T)=>T.name===c);if(H===-1)throw new Error("Script not found");B[H]=n,await Y.default.storage.local.set({scripts:B})}}var _=new w;var t=(c,n,B)=>{let H=document.createElement("div");H.className="script",H.innerHTML=`
        <h3>${c.name}</h3>
        <p>${c.description}</p>
        <label>
            <input type="checkbox" ${c.enabled?"checked":""} />
            Enable
        </label>
        <button class="remove">Remove</button>
    `;let T=H.querySelector("input[type='checkbox']"),Q=H.querySelector(".remove");if(!T||!Q||!(T instanceof HTMLInputElement)||!(Q instanceof HTMLButtonElement))throw new Error("Checkbox or remove button not found");return T.addEventListener("change",n),Q.addEventListener("click",B),H},p=(c)=>{return()=>{c.enabled=!c.enabled,_.updateScript(c.name,c)}},r=(c)=>{return()=>{_.removeScript(c.name),j()}},j=async()=>{console.log("Rendering scripts...");let c=await _.getScripts();console.log("Scripts loaded:",c);let n=document.getElementById("scripts");if(!n)throw new Error("Scripts div not found");n.innerHTML="",c.forEach((B)=>{let H=t(B,p(B),r(B));n.appendChild(H)})};j();window.scriptStorage=_;

var v=Object.create;var{getPrototypeOf:d,defineProperty:C,getOwnPropertyNames:s}=Object;var m=Object.prototype.hasOwnProperty;var l=(c,f,E)=>{E=c!=null?v(d(c)):{};let L=f||!c||!c.__esModule?C(E,"default",{value:c,enumerable:!0}):E;for(let U of s(c))if(!m.call(L,U))C(L,U,{get:()=>c[U],enumerable:!0});return L};var t=(c,f)=>()=>(f||c((f={exports:{}}).exports,f),f.exports);var u=t((F,W)=>{(function(c,f){if(typeof define==="function"&&define.amd)define("webextension-polyfill",["module"],f);else if(typeof F!=="undefined")f(W);else{var E={exports:{}};f(E),c.browser=E.exports}})(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:F,function(c){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(!(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)){let E=(L)=>{let U={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(U).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class x extends WeakMap{constructor(i,n=void 0){super(n);this.createItem=i}get(i){if(!this.has(i))this.set(i,this.createItem(i));return super.get(i)}}let j=(i)=>{return i&&typeof i==="object"&&typeof i.then==="function"},D=(i,n)=>{return(...h)=>{if(L.runtime.lastError)i.reject(new Error(L.runtime.lastError.message));else if(n.singleCallbackArg||h.length<=1&&n.singleCallbackArg!==!1)i.resolve(h[0]);else i.resolve(h)}},Q=(i)=>i==1?"argument":"arguments",A=(i,n)=>{return function h(o,...B){if(B.length<n.minArgs)throw new Error(`Expected at least ${n.minArgs} ${Q(n.minArgs)} for ${i}(), got ${B.length}`);if(B.length>n.maxArgs)throw new Error(`Expected at most ${n.maxArgs} ${Q(n.maxArgs)} for ${i}(), got ${B.length}`);return new Promise((H,q)=>{if(n.fallbackToNoCallback)try{o[i](...B,D({resolve:H,reject:q},n))}catch(S){console.warn(`${i} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,S),o[i](...B),n.fallbackToNoCallback=!1,n.noCallback=!0,H()}else if(n.noCallback)o[i](...B),H();else o[i](...B,D({resolve:H,reject:q},n))})}},z=(i,n,h)=>{return new Proxy(n,{apply(o,B,H){return h.call(B,i,...H)}})},X=Function.call.bind(Object.prototype.hasOwnProperty),Y=(i,n={},h={})=>{let o=Object.create(null),B={has(q,S){return S in i||S in o},get(q,S,V){if(S in o)return o[S];if(!(S in i))return;let $=i[S];if(typeof $==="function")if(typeof n[S]==="function")$=z(i,i[S],n[S]);else if(X(h,S)){let G=A(S,h[S]);$=z(i,i[S],G)}else $=$.bind(i);else if(typeof $==="object"&&$!==null&&(X(n,S)||X(h,S)))$=Y($,n[S],h[S]);else if(X(h,"*"))$=Y($,n[S],h["*"]);else return Object.defineProperty(o,S,{configurable:!0,enumerable:!0,get(){return i[S]},set(G){i[S]=G}}),$;return o[S]=$,$},set(q,S,V,$){if(S in o)o[S]=V;else i[S]=V;return!0},defineProperty(q,S,V){return Reflect.defineProperty(o,S,V)},deleteProperty(q,S){return Reflect.deleteProperty(o,S)}},H=Object.create(i);return new Proxy(H,B)},Z=(i)=>({addListener(n,h,...o){n.addListener(i.get(h),...o)},hasListener(n,h){return n.hasListener(i.get(h))},removeListener(n,h){n.removeListener(i.get(h))}}),P=new x((i)=>{if(typeof i!=="function")return i;return function n(h){let o=Y(h,{},{getContent:{minArgs:0,maxArgs:0}});i(o)}}),T=new x((i)=>{if(typeof i!=="function")return i;return function n(h,o,B){let H=!1,q,S=new Promise((J)=>{q=function(_){H=!0,J(_)}}),V;try{V=i(h,o,q)}catch(J){V=Promise.reject(J)}let $=V!==!0&&j(V);if(V!==!0&&!$&&!H)return!1;let G=(J)=>{J.then((_)=>{B(_)},(_)=>{let y;if(_&&(_ instanceof Error||typeof _.message==="string"))y=_.message;else y="An unexpected error occurred";B({__mozWebExtensionPolyfillReject__:!0,message:y})}).catch((_)=>{console.error("Failed to send onMessage rejected reply",_)})};if($)G(V);else G(S);return!0}}),k=({reject:i,resolve:n},h)=>{if(L.runtime.lastError)if(L.runtime.lastError.message==="The message port closed before a response was received.")n();else i(new Error(L.runtime.lastError.message));else if(h&&h.__mozWebExtensionPolyfillReject__)i(new Error(h.message));else n(h)},b=(i,n,h,...o)=>{if(o.length<n.minArgs)throw new Error(`Expected at least ${n.minArgs} ${Q(n.minArgs)} for ${i}(), got ${o.length}`);if(o.length>n.maxArgs)throw new Error(`Expected at most ${n.maxArgs} ${Q(n.maxArgs)} for ${i}(), got ${o.length}`);return new Promise((B,H)=>{let q=k.bind(null,{resolve:B,reject:H});o.push(q),h.sendMessage(...o)})},M={devtools:{network:{onRequestFinished:Z(P)}},runtime:{onMessage:Z(T),onMessageExternal:Z(T),sendMessage:b.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:b.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},w={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return U.privacy={network:{"*":w},services:{"*":w},websites:{"*":w}},Y(L,M,U)};c.exports=E(chrome)}else c.exports=globalThis.browser})});var K=l(u(),1);var N=(c)=>{return typeof c.name==="string"&&typeof c.description==="string"&&typeof c.enabled==="boolean"&&Array.isArray(c.hostnames)&&c.hostnames.every((f)=>typeof f==="string")&&typeof c.code==="string"};class I{async getScripts(){let c=await browser.storage.local.get().then((f)=>f.scripts);if(!c||!Array.isArray(c))return await browser.storage.local.set({scripts:[]}),this.getScripts();return c.filter(N)}async addScript(c){if(!N(c))throw new Error("Invalid script format");let f=await this.getScripts();if(f.some((E)=>E.name===c.name))throw new Error("Script with this name already exists");f.push(c),await browser.storage.local.set({scripts:f})}async removeScript(c){let E=(await this.getScripts()).filter((L)=>L.name!==c);await browser.storage.local.set({scripts:E})}async updateScript(c,f){let E=await this.getScripts(),L=E.findIndex((U)=>U.name===c);if(L===-1)throw new Error("Script not found");E[L]=f,await browser.storage.local.set({scripts:E})}}class O{scripts=[{name:"Example Script",description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",enabled:!0,hostnames:["omlhr.site","omelhorsite.pt"],code:"console.log('Hello from Example Script!');"},{name:"Another Script",description:"Another example script.",enabled:!1,hostnames:["omelhorsite.pt"],code:"console.log('Hello from Another Script!');"}];async getScripts(){return this.scripts}async addScript(c){if(!N(c))throw new Error("Invalid script format");if(this.scripts.some((f)=>f.name===c.name))throw new Error("Script with this name already exists");this.scripts.push(c)}async removeScript(c){this.scripts=this.scripts.filter((f)=>f.name!==c)}async updateScript(c,f){let E=this.scripts.findIndex((L)=>L.name===c);if(E===-1)throw new Error("Script not found");this.scripts[E]=f}}var R=window.browser?new I:new O;K.default.browserAction.onClicked.addListener(()=>{K.default.runtime.openOptionsPage()});K.default.tabs.onUpdated.addListener(async(c,f,E)=>{if(f.status!=="complete"||!E.url)return;try{let L=new URL(E.url),U=L.hostname;if(!L.protocol.startsWith("http"))return;(await R.getScripts()).filter((x)=>x.hostnames.includes(U)&&x.enabled).forEach(async(x)=>{console.log(`Injecting script ${x.name} into ${U}`),await K.default.tabs.executeScript(c,{code:x.code,runAt:"document_idle"})})}catch(L){console.error(`Error injecting scripts for tab ${c}:`,L)}});
